	CREATE
	VIEW t2tierp.VIEW_COMPRA_MAPA_COMPARATIVO
	AS
	(
	select 
	  CONCAT(COTA.ID, CFC.ID, CCD.ID, CCD.ID_PRODUTO, FORN.ID) as ID,
	  COTA.ID AS ID_COMPRA_COTACAO, CFC.ID AS ID_COMPRA_FORNECEDOR_COTACAO, CCD.ID AS ID_COMPRA_COTACAO_DETALHE, CCD.ID_PRODUTO, FORN.ID AS ID_FORNECEDOR,
	  PRO.NOME AS PRODUTO_NOME, PES.NOME AS FORNECEDOR_NOME, CCD.QUANTIDADE, CCD.QUANTIDADE_PEDIDA, 
	  CCD.VALOR_UNITARIO, CCD.VALOR_SUBTOTAL, CCD.TAXA_DESCONTO, CCD.VALOR_DESCONTO, CCD.VALOR_TOTAL
	from
	  COMPRA_COTACAO COTA 
	  INNER JOIN COMPRA_FORNECEDOR_COTACAO CFC ON (COTA.ID = CFC.ID_COMPRA_COTACAO)
	  INNER JOIN COMPRA_COTACAO_DETALHE CCD ON (CFC.ID = CCD.ID_COMPRA_FORNECEDOR_COTACAO)
	  INNER JOIN PRODUTO PRO ON (PRO.ID = CCD.ID_PRODUTO)
	  INNER JOIN FORNECEDOR FORN ON (FORN.ID = CFC.ID_FORNECEDOR)
	  INNER JOIN PESSOA PES ON (PES.ID = FORN.ID_PESSOA)
	order by PRO.NOME, PES.NOME
	)